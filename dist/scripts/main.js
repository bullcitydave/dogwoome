"use strict";function Dog(e,t){t=t||{},this.name=e,this.avatar=t.avatar,this.color=t.color,this.age=t.age}function Adopter(e,t){t=t||{},this.name=e,this.avatar=t.avatar,this.tolLick=t.tolLick||5,this.tolCuddle=t.tolCuddle||5,this.tolBark=t.tolBark||5}function populateAdopterChoices(e){for(var t=0;t<_.size(e);t++)$(".adopter-choices").append(_.template(adopterSelectView,{imgURL:e[t].avatar,adoptername:e[t].name}))}function populateDogChoices(e){for(var t=0;t<_.size(e);t++)$(".dog-choices").append(_.template(dogSelectView,{imgURL:e[t].avatar,dogname:e[t].name,dogindex:t}))}function win(e){percent.html(100),wooAlert(e[1]+" wants to adopt "+e[0]+"!"),won=!0}function moveProgress(e){var t=parseInt($(".woobar").css("width")),o=parseInt($(".woobarprog").css("width")),a=o+t*(e/100)+"px";woobarprog.css("width",a)}function resetGame(){resetStyles(),resetData(),resetDisplay()}function resetStyles(){game.css("opacity",.25),lick.css("opacity",1),cuddle.css("opacity",1),bark.css("opacity",1),woobarprog.css("width",0),selectplayer.fadeIn(750)}function resetData(){Data=[{wooScore:0,totalLicks:0,totalCuddles:0,totalBarks:0}],wa=cartesianProductOf(dogNames,adopterNames,wooData),won=!1}function resetDisplay(){percent.html(0),sidebar.empty()}function wooAlert(e){$("#alert").fadeIn(750),$(".alert-msg").html(e)}function woof(){$("#woof").fadeIn(600),$("#woof").fadeOut(900)}function cartesianProductOf(){return _.reduce(arguments,function(e,t){return _.flatten(_.map(e,function(e){return _.map(t,function(t){return e.concat([t])})}),!0)},[[]])}var Moksha=new Dog("Moksha",{color:["brown","white"],age:4,avatar:"https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-xpa1/t31.0-8/1932629_10152418870378352_6293108892780372302_o.jpg"}),Emmitt=new Dog("Emmitt",{color:["yellow"],age:5,avatar:"https://fbcdn-sphotos-h-a.akamaihd.net/hphotos-ak-xap1/t1.0-9/60479_432375844549_1903986_n.jpg"}),Bella=new Dog("Bella",{color:["black"],age:2,avatar:"https://scontent-b-lga.xx.fbcdn.net/hphotos-xfp1/t1.0-9/4541_89487809549_852660_n.jpg"}),Herman=new Dog("Herman",{color:["black","white"],age:6,avatar:"http://i.imgur.com/s7mpWGj.jpg"}),Dogs=[Moksha,Emmitt,Bella,Herman],dogNames=Dogs.map(function(e){return e.name}),Dave=new Adopter("Dave",{tolLick:7,tolCuddle:4,tolBark:5,avatar:"https://dge9rmgqjs8m1.cloudfront.net/global/6e784a56292505372595b9023b9cdc970010/original.6e784a56292505372595b9023b9cdc970010.gif"}),Emily=new Adopter("Emily",{tolLick:4,tolCuddle:6,tolBark:3,avatar:"https://asset1.basecamp.com/1940253/people/8112581/photo/avatar.96.gif"}),Julia=new Adopter("Julia",{tolLick:10,tolCuddle:3,tolBark:7,avatar:"https://avatars0.githubusercontent.com/u/955558?s=460"}),Talal=new Adopter("Talal",{avatar:"https://avatars1.githubusercontent.com/u/3066028?s=400"}),Adopters=[Dave,Emily,Julia,Talal],adopterNames=Adopters.map(function(e){return e.name}),lickPts=5,cuddlePts=10,barkPts=-4,wooData=[{wooScore:0,totalLicks:0,totalCuddles:0,totalBarks:0}],wa=cartesianProductOf(dogNames,adopterNames,wooData),game=$("#main-game"),sidebar=$("#sidebar"),selectplayer=$("#select-player"),selectadopter=$("#select-adopter"),lick=$("#lick"),cuddle=$("#cuddle"),bark=$("#bark"),percent=$(".percent"),woobarprog=$(".woobarprog"),dogSelectView=$("#dog-select-template").html(),adopterSelectView=$("#adopter-select-template").html(),dogView=$("#sidebar-template").html(),won=!1,dogname="",adoptername="",dogpos=0,adopterpos=0;$(document).ready(function(){$("h1").lettering(),populateDogChoices(Dogs),populateAdopterChoices(Adopters),$(".dog-selection-entry").click(function(){event.preventDefault(),dogname=$(this).children(".dog-selection-button").html(),dogpos=$.inArray(dogname,dogNames),sidebar.append(_.template(dogView,{imgURL:Dogs[dogpos].avatar,dogname:dogname})),selectplayer.fadeOut(750),selectadopter.fadeIn(750)}),$(".adopter-selection-entry").click(function(){event.preventDefault(),adoptername=$(this).children("button").html(),adopterpos=$.inArray(adoptername,adopterNames),selectadopter.fadeOut(750),game.css("opacity",1),$(".adopter-avatar img").attr("src",eval(adoptername).avatar)})}),lick.click(function(){event.preventDefault();var e=Adopters[adopterpos].tolLick;$.each(wa,function(t,o){o[0]===dogname&&o[1]===adoptername&&(o[2].totalLicks<e?(o[2].wooScore+=lickPts,o[2].totalLicks++,moveProgress(lickPts),percent.html(o[2].wooScore),o[2].wooScore>=100&&win(o)):(wooAlert("That's enough licks for now!"),lick.css("opacity",.15)))})}),cuddle.click(function(){event.preventDefault();var e=Adopters[adopterpos].tolCuddle;$.each(wa,function(t,o){o[0]===dogname&&o[1]===adoptername&&(o[2].totalCuddles<e?(o[2].totalCuddles++,o[2].wooScore+=cuddlePts,moveProgress(cuddlePts),percent.html(o[2].wooScore),o[2].wooScore>=100&&win(o)):(wooAlert("That's enough cuddles for now!"),cuddle.css("opacity",.15)))})}),bark.click(function(){event.preventDefault(),woof();var e=Adopters[adopterpos].tolBark;$.each(wa,function(t,o){o[0]===dogname&&o[1]===adoptername&&(o[2].totalBarks<e?(o[2].totalBarks++,o[2].wooScore+=barkPts,moveProgress(barkPts),percent.html(o[2].wooScore),o[2].wooScore<0&&(o[2].wooScore=0,percent.html(0),wooAlert("Maybe you should try something else!")),3===o[2].totalBarks&&e>3&&wooAlert("Don't give up!")):(wooAlert("OK, OK, come back over here!"),bark.css("opacity",.15),o[2].totalCuddles=0,o[2].totalLicks=0,cuddle.css("opacity",1),lick.css("opacity",1)))})}),$(".close").click(function(e){e.preventDefault(),$("#alert").fadeOut(700),won&&resetGame()});