"use strict";function Dog(t,e){e=e||{},this.name=t,this.avatar=e.avatar,this.color=e.color,this.age=e.age}function Adopter(t,e){e=e||{},this.name=t,this.avatar=e.avatar,this.tolLick=e.tolLick||5,this.tolCuddle=e.tolCuddle||5,this.tolBark=e.tolBark||5}function populateAdopterChoices(t){for(var e=0;e<_.size(t);e++)$(".adopter-choices").append(_.template(adopterSelectView,{imgURL:t[e].avatar,adoptername:t[e].name}))}function populateDogChoices(t){for(var e=0;e<_.size(t);e++)$(".dog-choices").append(_.template(dogSelectView,{imgURL:t[e].avatar,dogname:t[e].name,dogindex:e}))}function win(t){$(".percent").html(100),wooAlert(t[1]+" wants to adopt "+t[0]+"!"),won=!0}function moveProgress(t){var e=parseInt($(".woobar").css("width")),o=parseInt($(".woobarprog").css("width")),a=o+e*(t/100)+"px";$(".woobarprog").css("width",a)}function resetGame(){$(".woobarprog").css("width",0),$(".percent").html(0),$("#sidebar").empty(),game.css("opacity",.25),$("#lick").css("opacity",1),$("#cuddle").css("opacity",1),$("#bark").css("opacity",1),wooData=[{wooScore:0,totalLicks:0,totalCuddles:0,totalBarks:0}],wa=cartesianProductOf(dogNames,adopterNames,wooData),selectplayer.fadeIn(750),won=!1}function wooAlert(t){$("#alert").fadeIn(750),$(".alert-msg").html(t)}function woof(){$("#woof").fadeIn(600),$("#woof").fadeOut(900)}function cartesianProductOf(){return _.reduce(arguments,function(t,e){return _.flatten(_.map(t,function(t){return _.map(e,function(e){return t.concat([e])})}),!0)},[[]])}var Moksha=new Dog("Moksha",{color:["brown","white"],age:4,avatar:"https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-xpa1/t31.0-8/1932629_10152418870378352_6293108892780372302_o.jpg"}),Emmitt=new Dog("Emmitt",{color:["yellow"],age:5,avatar:"https://fbcdn-sphotos-h-a.akamaihd.net/hphotos-ak-xap1/t1.0-9/60479_432375844549_1903986_n.jpg"}),Bella=new Dog("Bella",{color:["black"],age:2,avatar:"https://scontent-b-lga.xx.fbcdn.net/hphotos-xfp1/t1.0-9/4541_89487809549_852660_n.jpg"}),Herman=new Dog("Herman",{color:["black","white"],age:6,avatar:"http://i.imgur.com/s7mpWGj.jpg"}),Dogs=[Moksha,Emmitt,Bella,Herman],dogNames=Dogs.map(function(t){return t.name}),Dave=new Adopter("Dave",{tolLick:7,tolCuddle:4,tolBark:5,avatar:"https://dge9rmgqjs8m1.cloudfront.net/global/6e784a56292505372595b9023b9cdc970010/original.6e784a56292505372595b9023b9cdc970010.gif"}),Emily=new Adopter("Emily",{tolLick:4,tolCuddle:6,tolBark:3,avatar:"https://asset1.basecamp.com/1940253/people/8112581/photo/avatar.96.gif"}),Julia=new Adopter("Julia",{tolLick:10,tolCuddle:3,tolBark:7,avatar:"https://avatars0.githubusercontent.com/u/955558?s=460"}),Talal=new Adopter("Talal",{avatar:"https://avatars1.githubusercontent.com/u/3066028?s=400"}),Adopters=[Dave,Emily,Julia,Talal],adopterNames=Adopters.map(function(t){return t.name}),lickPts=5,cuddlePts=10,barkPts=-4,wooData=[{wooScore:0,totalLicks:0,totalCuddles:0,totalBarks:0}],wa=cartesianProductOf(dogNames,adopterNames,wooData),game=$("#main-game"),sidebar=$("#sidebar"),selectplayer=$("#select-player"),selectadopter=$("#select-adopter"),lick=$("#lick"),cuddle=$("#cuddle"),bark=$("#bark"),dogSelectView=$("#dog-select-template").html(),adopterSelectView=$("#adopter-select-template").html(),dogView=$("#sidebar-template").html(),won=!1,dogname="",adoptername="",dogpos=0,adopterpos=0;$(document).ready(function(){$("h1").lettering(),populateDogChoices(Dogs),populateAdopterChoices(Adopters),$(".dog-selection-entry").click(function(){event.preventDefault(),dogname=$(this).children(".dog-selection-button").html(),dogpos=$.inArray(dogname,dogNames),sidebar.append(_.template(dogView,{imgURL:Dogs[dogpos].avatar,dogname:dogname})),selectplayer.fadeOut(750),selectadopter.fadeIn(750)}),$(".adopter-selection-entry").click(function(){event.preventDefault(),adoptername=$(this).children("button").html(),adopterpos=$.inArray(adoptername,adopterNames),selectadopter.fadeOut(750),game.css("opacity",1),$(".adopter-avatar img").attr("src",eval(adoptername).avatar)})}),lick.click(function(){event.preventDefault();var t=Adopters[adopterpos].tolLick;$.each(wa,function(e,o){o[0]===dogname&&o[1]===adoptername&&(o[2].totalLicks<t?(o[2].wooScore+=lickPts,o[2].totalLicks++,moveProgress(lickPts),$(".percent").html(o[2].wooScore),o[2].wooScore>=100&&win(o)):(wooAlert("That's enough licks for now!"),lick.css("opacity",.15)))})}),cuddle.click(function(){event.preventDefault();var t=Adopters[adopterpos].tolCuddle;$.each(wa,function(e,o){o[0]===dogname&&o[1]===adoptername&&(o[2].totalCuddles<t?(o[2].totalCuddles++,o[2].wooScore+=cuddlePts,moveProgress(cuddlePts),$(".percent").html(o[2].wooScore),o[2].wooScore>=100&&win(o)):(wooAlert("That's enough cuddles for now!"),cuddle.css("opacity",.15)))})}),bark.click(function(){event.preventDefault(),woof();var t=Adopters[adopterpos].tolBark;$.each(wa,function(e,o){o[0]===dogname&&o[1]===adoptername&&(o[2].totalBarks<t?(o[2].totalBarks++,o[2].wooScore+=barkPts,moveProgress(barkPts),$(".percent").html(o[2].wooScore),o[2].wooScore<0&&(o[2].wooScore=0,$(".percent").html(0),wooAlert("Maybe you should try something else!")),3===o[2].totalBarks&&t>3&&wooAlert("Don't give up!")):(wooAlert("OK, OK, come back over here!"),bark.css("opacity",.15),o[2].totalCuddles=0,o[2].totalLicks=0,cuddle.css("opacity",1),lick.css("opacity",1)))})}),$(".close").click(function(t){t.preventDefault(),$("#alert").fadeOut(700),won&&resetGame()});