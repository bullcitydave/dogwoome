"use strict";function Dog(t,a){a=a||{},this.name=t,this.color=a.color,this.age=a.age,this.breeds=a.breeds||"mutt",this.weight=a.weight,this.barkVol=a.barkVol||5,this.avatar=a.avatar,this.lick=function(t){return t.licked=!0},this.cuddle=function(t){return t.cuddled=!0},this.bark=function(t){return t.barkedAt=!0}}function Adopter(t,a){a=a||{},this.name=t,this.licked=!1,this.cuddled=!1,this.tolLick=a.tolLick||5,this.tolCuddle=a.tolCuddle||5,this.tolBark=a.tolBark||5,this.prefAge=a.prefAge,this.avatar=a.avatar}function populateDogChoices(t){for(var a=$("#dog-select-template").html(),e=0;e<_.size(t);e++)$(".dog-choices").append(_.template(a,{imgURL:t[e].avatar,dogname:t[e].name,dogindex:e}))}function populateAdopterChoices(t){for(var a=$("#adopter-select-template").html(),e=0;e<_.size(t);e++)$(".adopter-choices").append(_.template(a,{imgURL:t[e].avatar,adoptername:t[e].name}))}function win(t){$(".percent").html(100),wooAlert(t[1]+" wants to adopt "+t[0]+"!"),won=!0}function moveProgress(t){var a=parseInt($(".woobar").css("width")),e=parseInt($(".woobarprog").css("width")),o=e+a*(t/100)+"px";$(".woobarprog").css("width",o)}function resetGame(){$(".woobarprog").css("width",0),$(".percent").html(0),$("#sidebar").empty(),$("#main-game").css("opacity",.25),$("#lick").css("opacity",1),$("#cuddle").css("opacity",1),$("#bark").css("opacity",1),wooData=[{wooScore:0,totalLicks:0,totalCuddles:0,totalBarks:0}],wa=cartesianProductOf(dogNames,adopterNames,wooData),$("#select-player").fadeIn(750),won=!1}function wooAlert(t){$("#alert").fadeIn(750),$(".alert-msg").html(t)}function woof(){$("#woof").fadeIn(700),$("#woof").fadeOut(2300)}function cartesianProductOf(){return _.reduce(arguments,function(t,a){return _.flatten(_.map(t,function(t){return _.map(a,function(a){return t.concat([a])})}),!0)},[[]])}var Moksha=new Dog("Moksha",{color:["brown","white"],age:4,avatar:"https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-xpa1/t31.0-8/1932629_10152418870378352_6293108892780372302_o.jpg"}),Emmitt=new Dog("Emmitt",{color:["yellow"],age:5,avatar:"https://fbcdn-sphotos-h-a.akamaihd.net/hphotos-ak-xap1/t1.0-9/60479_432375844549_1903986_n.jpg"}),Bella=new Dog("Bella",{color:["black"],age:2,avatar:"https://scontent-b-lga.xx.fbcdn.net/hphotos-xfp1/t1.0-9/4541_89487809549_852660_n.jpg"}),Herman=new Dog("Herman",{color:["black","white"],age:6,avatar:"http://i.imgur.com/s7mpWGj.jpg"}),Dogs=[Moksha,Emmitt,Bella,Herman],dogNames=Dogs.map(function(t){return t.name}),Dave=new Adopter("Dave",{tolLick:7,tolCuddle:4,tolBark:5,avatar:"https://dge9rmgqjs8m1.cloudfront.net/global/6e784a56292505372595b9023b9cdc970010/original.6e784a56292505372595b9023b9cdc970010.gif"}),Emily=new Adopter("Emily",{tolLick:4,tolCuddle:6,tolBark:3,avatar:"https://asset1.basecamp.com/1940253/people/8112581/photo/avatar.96.gif"}),Julia=new Adopter("Julia",{tolLick:10,tolCuddle:3,tolBark:7,avatar:"https://avatars0.githubusercontent.com/u/955558?s=460"}),Talal=new Adopter("Talal",{avatar:"https://avatars1.githubusercontent.com/u/3066028?s=400"}),Adopters=[Dave,Emily,Julia,Talal],adopterNames=Adopters.map(function(t){return t.name}),lickPts=5,cuddlePts=10,barkPts=-4,wooData=[{wooScore:0,totalLicks:0,totalCuddles:0,totalBarks:0}],wa=cartesianProductOf(dogNames,adopterNames,wooData),won=!1,dogname="",dogPos=0,adoptername="",adopterPos=0;$(document).ready(function(){$("h1").lettering(),$("#main-game").css("opacity",.25),populateDogChoices(Dogs),populateAdopterChoices(Adopters),$(".dog-selection-entry").click(function(){event.preventDefault(),dogname=$(this).children(".dog-selection-button").html(),dogPos=$(this).children(".index-ignore").html();var t=$("#sidebar-template").html();$("#sidebar").append(_.template(t,{imgURL:Dogs[dogPos].avatar,dogname:dogname})),$("#select-player").fadeOut(750),$("#select-adopter").fadeIn(750)}),$(".adopter-selection-entry").click(function(){event.preventDefault(),adoptername=$(this).children("button").html(),$("#select-adopter").fadeOut(750),$(""),$("#main-game").css("opacity",1),$(".adopter-avatar img").attr("src",eval(adoptername).avatar)})}),$("#lick").click(function(){event.preventDefault(),dogPos=$.inArray(dogname,dogNames),adopterPos=$.inArray(adoptername,adopterNames);var t=Adopters[adopterPos].tolLick;$.each(wa,function(a,e){e[0]===dogname&&e[1]===adoptername&&(wa[a][2].totalLicks<t?(wa[a][2].wooScore+=lickPts,wa[a][2].totalLicks++,moveProgress(lickPts),$(".percent").html(wa[a][2].wooScore),wa[a][2].wooScore>=100&&win(wa[a])):(wooAlert("That's enough licks for now!"),$("#lick").css("opacity",.15)))})}),$("#cuddle").click(function(){event.preventDefault(),dogPos=$.inArray(dogname,dogNames),adopterPos=$.inArray(adoptername,adopterNames);var t=Adopters[adopterPos].tolCuddle;$.each(wa,function(a,e){e[0]===dogname&&e[1]===adoptername&&(wa[a][2].totalCuddles<t?(wa[a][2].totalCuddles++,wa[a][2].wooScore+=cuddlePts,moveProgress(cuddlePts),$(".percent").html(wa[a][2].wooScore),wa[a][2].wooScore>=100&&win(wa[a])):(wooAlert("That's enough cuddles for now!"),$("#cuddle").css("opacity",.15)))})}),$("#bark").click(function(){event.preventDefault(),woof(),dogPos=$.inArray(dogname,dogNames),adopterPos=$.inArray(adoptername,adopterNames);var t=Adopters[adopterPos].tolBark;$.each(wa,function(a,e){e[0]===dogname&&e[1]===adoptername&&(wa[a][2].totalBarks<t?(wa[a][2].totalBarks++,wa[a][2].wooScore+=barkPts,moveProgress(barkPts),$(".percent").html(wa[a][2].wooScore),wa[a][2].wooScore<0&&(wa[a][2].wooScore=0,$(".percent").html(0),wooAlert("Maybe you should try something else!")),3===wa[a][2].totalBarks&&t>3&&jQuery.delay(2e3).wooAlert("Don't give up!")):(wooAlert("OK, OK, come back over here!"),$("#bark").css("opacity",.15),wa[a][2].totalCuddles=0,wa[a][2].totalLicks=0,$("#cuddle").css("opacity",1),$("#lick").css("opacity",1)))})}),$(".close").click(function(t){t.preventDefault(),$("#alert").fadeOut(700),won&&resetGame()});
